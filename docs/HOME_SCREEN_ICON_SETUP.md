# Home Screen Icon Setup (PWA / Add to Home Screen)

Exact setup used for the Army Ticket Board home screen icon. The icon still does not display on some devices (e.g. iOS); only the app name or "A" may show.

---

## 1. Asset location

- **File:** `public/army-ticket-board-logo.png`
- **URL:** Served at `/army-ticket-board-logo.png` (Next.js serves `public/` from root)
- **Framework:** Next.js (App Router), deployed on Vercel

---

## 2. Web App Manifest (`app/manifest.ts`)

The manifest is generated by a dynamic route. Icon URLs are built with an absolute base when possible.

```ts
import type { MetadataRoute } from "next";

export default function manifest(): MetadataRoute.Manifest {
  const base =
    typeof process.env.NEXT_PUBLIC_SITE_URL === "string" && process.env.NEXT_PUBLIC_SITE_URL
      ? process.env.NEXT_PUBLIC_SITE_URL.replace(/\/$/, "")
      : process.env.VERCEL_URL
        ? `https://${process.env.VERCEL_URL}`
        : "";
  const iconPath = "/army-ticket-board-logo.png";
  const iconSrc = base ? `${base}${iconPath}` : iconPath;

  return {
    name: "Army Ticket Board",
    short_name: "Army Ticket Board",
    description: "Find and exchange BTS concert tickets with ARMY.",
    start_url: "/",
    scope: "/",
    id: "/",
    display: "standalone",
    display_override: ["standalone", "minimal-ui", "browser"],
    background_color: "#ffffff",
    theme_color: "#6b21a8",
    icons: [
      { src: iconSrc, sizes: "any", type: "image/png", purpose: "any" },
      { src: iconSrc, sizes: "192x192", type: "image/png", purpose: "any" },
      { src: iconSrc, sizes: "512x512", type: "image/png", purpose: "any" },
    ],
  };
}
```

- **Manifest URL:** `/manifest.webmanifest` (set in layout metadata).
- **Base URL:** Uses `NEXT_PUBLIC_SITE_URL` if set (e.g. `https://www.army-ticket-board.com`), else `https://${VERCEL_URL}`. If neither, icon `src` is the relative path `/army-ticket-board-logo.png`.
- **Icon entries:** Same PNG used for `any`, `192x192`, and `512x512`; the actual file may not be 192×192 or 512×512 pixels.

---

## 3. Layout metadata (`app/layout.tsx`)

```ts
export const metadata: Metadata = {
  title: "Army Ticket Board",
  description: "...",
  icons: {
    icon: [{ url: "/army-ticket-board-logo.png", type: "image/png" }],
    apple: [{ url: "/army-ticket-board-logo.png", sizes: "180x180", type: "image/png" }],
  },
  manifest: "/manifest.webmanifest",
  appleWebApp: {
    capable: true,
    statusBarStyle: "default",
    title: "Army Ticket Board",
  },
};
```

- Favicon and Apple touch icon both point to `/army-ticket-board-logo.png` (relative).
- `appleWebApp` enables standalone mode and sets the title used when added to home screen.

---

## 4. Redirects (`next.config.ts`)

```ts
async redirects() {
  return [
    { source: "/icon.png", destination: "/army-ticket-board-logo.png", permanent: true },
    { source: "/apple-icon.png", destination: "/army-ticket-board-logo.png", permanent: true },
    // ...
  ];
}
```

So requests to `/icon.png` or `/apple-icon.png` are redirected to the logo.

---

## 5. Environment variables (Vercel)

- **Optional:** `NEXT_PUBLIC_SITE_URL` = full site URL, e.g. `https://www.army-ticket-board.com` (no trailing slash). Used as the base for manifest icon URLs when set.
- **Automatic on Vercel:** `VERCEL_URL` (e.g. `project.vercel.app`). Used when `NEXT_PUBLIC_SITE_URL` is not set.

---

## 6. What’s not done

- No separate 192×192 or 512×512 PNG; one file is used for all sizes.
- No `purpose: "maskable"` icon; only `purpose: "any"`.
- Layout icons use relative URLs (`/army-ticket-board-logo.png`), not absolute.

---

## 7. How to verify

1. Open the live site and go to `https://<your-domain>/manifest.webmanifest`. Check that `icons[].src` are full URLs (e.g. `https://www.army-ticket-board.com/army-ticket-board-logo.png`) when the env var is set.
2. Open `https://<your-domain>/army-ticket-board-logo.png` in a browser; the image should load.
3. Remove the site from the home screen, then add it again after deploying changes.

Use this document when asking for help (e.g. ChatGPT) to fix the home screen icon not showing.
